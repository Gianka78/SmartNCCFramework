<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no	initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" />

    <title>Smart NCC mobile APP by GD-Soft s.r.l.</title>

    <script src="cordova.js"></script>
    <script src="libs/evothings/evothings.js"></script>
    <script src="libs/evothings/ui/ui.js"></script>
    <script src="libs/evothings/easyble/easyble.js"></script>
    <script src="libs/jquery/jquery.js"></script>

	<style type="text/css">
        body {
            background: url(images/app_background.jpg) no-repeat center center fixed;
            -webkit-background-size: cover;
            -moz-background-size: cover;
            -o-background-size: cover;
            background-size: cover;
        }
    </style>
</head>

<body>
    <script>
        var isCordova = true;
        function loadjscssfile(filename, filetype) {
            if (filetype == "js") {
                var fileref = document.createElement('script')
                fileref.setAttribute("type", "text/javascript")
                fileref.setAttribute("src", filename)
            }
            else if (filetype == "css") {
                var fileref = document.createElement("link")
                fileref.setAttribute("rel", "stylesheet")
                fileref.setAttribute("type", "text/css")
                fileref.setAttribute("href", filename)
            }
            if (typeof fileref != "undefined")
                document.getElementsByTagName("head")[0].appendChild(fileref)
        }
        var rnd = Date.now();
        var host_prefix = "auto_host_byid";
        var framework_version = "Build 12.001 27-01-2017";
        console.log("framework_version" + framework_version);
        var remote_folder_url = "http://" + host_prefix + ".smartncc.it/repositorysmartticket_nccolAPP/SmartTicketMobile/";
        var import_script = remote_folder_url + "mobileticket_incl.js?rnd=" + rnd;
        //loadjscssfile(import_script, "js");
        //loadjscssfile("http://" + host_prefix + ".smartncc.it/repositorysmartticket_nccolAPP/SmartTicketMobile/tmp.js?rnd=" + rnd, "js");
        workoffline = false;
        $.ajax({
            url: import_script,
            dataType: "text",
            success: function (data) {
                loadjscssfile(import_script, "js");
            },
            error: function () {
                document.addEventListener('deviceready', function () {
                    window.resolveLocalFileSystemURL(cordova.file.dataDirectory, function (dirEntry) {
                        startURL = dirEntry.toURL() + "install_log.txt";
                        $.get(startURL, function (data) {
                            workoffline = true;
                            loadjscssfile(dirEntry.toURL() + "mobileticket_incl.js", "js");
                        })
                        .fail(function () {
                            alert("Questa applicazione richiede una connessione a internet. Chiudere e riaprire.");
                        });
                    });
                });
            }
        });
    </script>

    <div class="app_loading_spalsh"></div>

    <div id="ncc_app_body"></div>

    <div id="ncc_app_footer"></div>

    <div id="dialog_div" class="dialog_div">
        <div id="dialog_frame" class="dialog_frame">
            <img id="dialog_img" src="" />
            <span id="dialog_txt"></span>
            <span id="yes_btn"></span>
            <span id="no_btn"></span>
        </div>
    </div>
</body>
</html>
